{% extends 'livres/base.html' %}

{% block title %}Nouvel emprunt - Bibliothèque{% endblock %}

{% block content %}
<div class="container" style="margin-top: 3rem; max-width: 700px;">
    <div style="margin-bottom: 2rem;">
        <a href="{% url 'emprunt_list' %}" style="color: var(--color-text-muted);">← Retour à la liste</a>
    </div>

    <div class="card fade-in">
        <h1 class="card-title">Enregistrer un nouvel emprunt</h1>

        <form method="post" style="margin-top: 2rem;">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="livre" class="form-label">Livre *</label>
                <select id="livre" name="livre" class="form-control form-select" required>
                    <option value="">Sélectionnez un livre</option>
                    {% for livre in livres %}
                        <option value="{{ livre.pk }}" {% if not livre.est_disponible %}disabled{% endif %}>
                            {{ livre.titre }} - {{ livre.auteur }}
                            {% if not livre.est_disponible %} (Déjà emprunté){% endif %}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="date_emprunt" class="form-label">Date d'emprunt *</label>
                <input 
                    type="date" 
                    id="date_emprunt" 
                    name="date_emprunt" 
                    class="form-control" 
                    value="{{ today }}"
                    required
                >
            </div>

            <div style="margin-top: 2rem; display: flex; gap: 1rem;">
                <button type="submit" class="btn btn-primary" style="flex: 1;">
                    Enregistrer l'emprunt
                </button>
                <a href="{% url 'emprunt_list' %}" class="btn btn-secondary">
                    Annuler
                </a>
            </div>
        </form>
    </div>

    <!-- Liste des livres disponibles -->
    <div style="margin-top: 2rem; padding: 1.5rem; background: var(--color-bg); border-radius: var(--radius-md);">
        <h3 style="font-size: 1rem; margin-bottom: 1rem; color: var(--color-text-muted);">
            Astuce : Seuls les livres disponibles peuvent être empruntés
        </h3>
        <p style="font-size: 0.9rem; color: var(--color-text-muted); margin: 0;">
            Les livres déjà empruntés sont désactivés dans la liste de sélection.
        </p>
    </div>
</div>
{% endblock %}
